# Avancement de la Branche - D√©veloppement Forum

## Informations de Branche

**Branche actuelle**: feature/forum
**Branche parent**: main
**Cr√©√©e le**: 2025-10-30
**Objectif**: Impl√©mentation compl√®te du syst√®me de forum pour le jeu "√ârosion des √Çmes"

---

## Contexte

Cette branche principale g√®re le d√©veloppement complet du syst√®me de forum pour le jeu post-apocalyptique "√ârosion des √Çmes". Elle coordonne plusieurs sous-branches pour impl√©menter progressivement toutes les fonctionnalit√©s n√©cessaires.

---

## Architecture du Syst√®me Forum

### Entit√©s du Jeu
- **Ethnies**: Les √âveill√©s (mutants), Les Inalt√©r√©s (humains purs)
- **Factions**: 2 factions principales en guerre
  - Les √âclaireurs de l'Aube Nouvelle (avant-poste: L'Oasis des Transform√©s)
  - Les Veilleurs de l'Ancien Monde (avant-poste: La Citadelle du Renouveau)
- **Clans**: 22 clans (2 leaders, 10 jouables, 10 neutres)
- **Personnages**: Personnages joueurs et PNJ

### Structure Forum
- **Cat√©gories**: Regroupements principaux (G√©n√©ral, HRP, RP)
- **Sections**: Sections th√©matiques avec permissions faction/clan
- **Topics**: Sujets de discussion
- **Posts**: Messages dans les topics
- **Double auteur**: User (HRP) OU Character (RP)

---

## Sous-Branches

### 1. ‚úÖ feature/forum-users-update (MERG√âE)
**Objectif**: Pr√©parer la table users pour le forum
**Commits**:
- d82f9bb: feat(backend): mise √† jour table users pour le forum
- 5850bc3: docs(forum): ajout documentation s√©curit√© et progression branche users
**Merg√©e le**: 2025-10-30

### 2. ‚úÖ feature/forum-tables (MERG√âE)
**Objectif**: Cr√©ation des tables de base de donn√©es
**Commits**:
- e78de58: feat(forum): cr√©ation tables de base de donn√©es forum complet
- b757b9e: refactor(docs): r√©organisation compl√®te de la documentation
- 0d6197c: refactor(docs): consolidation documentation dans BRANCH_PROGRESS.md
**Contenu**:
- 9 migrations (ethnies, factions, clans, characters, categories, sections, topics, posts, FK constraints)
- 9 mod√®les Sequelize avec associations
- 8 seeders de d√©veloppement avec donn√©es de test
**Merg√©e le**: 2025-10-30

### 3. üîÑ feature/seeders-review (EN COURS)
**Objectif**: R√©vision compl√®te des seeders avec donn√©es de production
**Branche de**: feature/forum
**Commits**:
- c47d6b0: docs(seeders): initialisation branche feature/seeders-review
- d855341: docs(seeders): mise √† jour structure avec sous-r√©pertoires
- 88bbf36: refactor(seeders): restructuration compl√®te avec s√©paration prod/dev
- 72189c9: feat(seeders): ajout scripts npm et mise √† jour documentation
- 7a0ef9a: feat(seeders): ajout donn√©es production compl√®tes √ârosion des √Çmes

**Contenu**:
- Restructuration: seeders/dev/ et seeders/prod/
- 9 seeders production avec vraies donn√©es du jeu
- 132 personnages PNJ d√©taill√©s
- 22 clans avec descriptions compl√®tes
- Structure forum (3 cat√©gories, 9 sections, 4 topics)
- Scripts npm: db:seed:prod et db:seed:dev

**√âtat**: ‚úÖ Compl√©t√©e, pr√™te √† merger dans feature/forum

---

## T√¢ches Globales de la Branche feature/forum

### Phase 1: Base de donn√©es ‚úÖ COMPL√âT√âE
- [x] Mise √† jour table users (feature/forum-users-update)
- [x] Cr√©ation migrations (feature/forum-tables)
- [x] Cr√©ation mod√®les Sequelize (feature/forum-tables)
- [x] Seeders de d√©veloppement (feature/forum-tables)
- [x] Seeders de production (feature/seeders-review)

### Phase 2: Backend API üìã √Ä FAIRE
- [ ] Routes CRUD pour ethnies
- [ ] Routes CRUD pour factions
- [ ] Routes CRUD pour clans
- [ ] Routes CRUD pour personnages
- [ ] Routes CRUD pour cat√©gories
- [ ] Routes CRUD pour sections
- [ ] Routes CRUD pour topics
- [ ] Routes CRUD pour posts
- [ ] Middleware de permissions (faction/clan)
- [ ] Middleware de s√©lection character pour RP

### Phase 3: Frontend Forum üìã √Ä FAIRE
- [ ] Page liste cat√©gories
- [ ] Page sections d'une cat√©gorie
- [ ] Page topics d'une section
- [ ] Page posts d'un topic
- [ ] Formulaire nouveau topic
- [ ] Formulaire nouveau post
- [ ] √âditeur markdown pour posts
- [ ] S√©lecteur de character pour posts RP
- [ ] Gestion permissions d'affichage

### Phase 4: Fonctionnalit√©s avanc√©es üìã √Ä FAIRE
- [ ] Syst√®me de mod√©ration
- [ ] √âpinglage/verrouillage de topics
- [ ] Notifications de nouveaux posts
- [ ] Recherche dans le forum
- [ ] Pagination des topics/posts
- [ ] Statistiques du forum

---

## Fichiers Cr√©√©s/Modifi√©s (Toutes sous-branches)

### Migrations (feature/forum-tables)
- backend/migrations/003-create-ethnies.js
- backend/migrations/004-create-factions.js (+ outpost_name dans seeders-review)
- backend/migrations/005-create-clans.js
- backend/migrations/006-create-characters.js
- backend/migrations/007-create-categories.js
- backend/migrations/008-create-sections.js
- backend/migrations/009-create-topics.js
- backend/migrations/010-create-posts.js
- backend/migrations/011-add-foreign-keys-constraints.js

### Mod√®les (feature/forum-tables)
- backend/src/models/Ethnie.js
- backend/src/models/Faction.js (+ outpost_name dans seeders-review)
- backend/src/models/Clan.js
- backend/src/models/Character.js
- backend/src/models/Category.js
- backend/src/models/Section.js
- backend/src/models/Topic.js
- backend/src/models/Post.js
- backend/src/models/index.js (associations)

### Seeders Dev (feature/forum-tables ‚Üí d√©plac√©s dans seeders-review)
- backend/seeders/dev/001-demo-users.js
- backend/seeders/dev/002-demo-ethnies.js
- backend/seeders/dev/003-demo-factions.js
- backend/seeders/dev/004-demo-clans.js
- backend/seeders/dev/005-demo-characters.js
- backend/seeders/dev/006-demo-categories.js
- backend/seeders/dev/007-demo-sections.js
- backend/seeders/dev/008-demo-topics.js
- backend/seeders/dev/009-demo-posts.js

### Seeders Prod (feature/seeders-review)
- backend/seeders/prod/001-prod-users.js
- backend/seeders/prod/002-prod-ethnies.js
- backend/seeders/prod/003-prod-factions.js
- backend/seeders/prod/004-prod-clans.js
- backend/seeders/prod/005-prod-characters.js
- backend/seeders/prod/006-prod-categories.js
- backend/seeders/prod/007-prod-sections.js
- backend/seeders/prod/008-prod-topics.js
- backend/seeders/prod/009-prod-posts.js

### Scripts
- backend/src/scripts/clearTable.js (feature/forum-tables)

### Documentation
- docs/architecture/database.md (mis √† jour dans forum-tables)
- docs/progress/branch-progress.md (ce fichier)
- docs/progress/branch-seeders-review.md (feature/seeders-review)

### Configuration
- backend/package.json (scripts npm ajout√©s dans les deux sous-branches)
- backend/seeders/README.md (feature/seeders-review)

---

## Donn√©es de Production (feature/seeders-review)

### Ethnies (2)
1. **Les √âveill√©s**: Mutants avec peau gris√¢tre
2. **Les Inalt√©r√©s**: Humains non mut√©s pr√©servant la puret√©

### Factions (2)
1. **Les √âclaireurs de l'Aube Nouvelle** (√âveill√©s)
   - Avant-poste: L'Oasis des Transform√©s
   - Id√©ologie: Mutation = √©volution divine, purifier la terre des non-mutants

2. **Les Veilleurs de l'Ancien Monde** (Inalt√©r√©s)
   - Avant-poste: La Citadelle du Renouveau
   - Id√©ologie: Technologie ancestrale, pr√©server la puret√© humaine

### Clans (22 total)

**√âclaireurs (6 clans)**:
- Leader: Les Proph√®tes de l'Harmonie (non jouable)
- Jouables: Symbiotes, Sensitifs, Forgerons de Chair, Sentinelles du Chaos, Scrutateurs

**Veilleurs (6 clans)**:
- Leader: Les √âlus d'Avant (non jouable)
- Jouables: Sentinelles, Pourvoyeurs, Archivistes, Purificateurs, Explorateurs

**Neutres (10 clans - non jouables)**:
- Veilleurs des Ruines, Peuple des Ombres, Vagabonds du Vent
- Artisans du R√©emploi, Fr√®res de la Terre Br√ªl√©e, Sanctuaire du Silence
- Collecteurs de Chuchotis, Semeurs d'Espoir, Loups Solitaires, D√©voreurs d'√Çmes

### Personnages (132 PNJ)
- 22 leaders de clans
- 30 membres clans jouables (3 par clan)
- 60 membres clans neutres (5 par clan)
- 10 membres factions sans clan (5 par faction)
- 10 solitaires (5 par ethnie)

### Forum
- 3 cat√©gories (G√©n√©ral, HRP, RP)
- 9 sections principales
- 4 topics (bienvenue, r√®glement, CGU, pr√©sentation)
- 1 post de bienvenue

---

## Prochaines Actions

### 1. Imm√©diat - Finaliser Phase 1
- [x] Merger feature/seeders-review dans feature/forum
- [ ] Tester l'int√©gralit√© de la base de donn√©es
- [ ] Merger feature/forum dans main

### 2. Phase 2 - Backend API
- Cr√©er sous-branche feature/forum-api
- Impl√©menter routes CRUD pour toutes les entit√©s
- Impl√©menter middleware de permissions
- Tests unitaires et d'int√©gration

### 3. Phase 3 - Frontend
- Cr√©er sous-branche feature/forum-frontend
- Interfaces de consultation (cat√©gories ‚Üí sections ‚Üí topics ‚Üí posts)
- Interfaces de cr√©ation (topics, posts)
- Int√©gration s√©lection de character pour RP

---

## Notes Techniques

### D√©cisions d'Architecture

**1. S√©paration dev/prod pour seeders**
- √âvite confusion entre donn√©es de test et donn√©es r√©elles
- Environnements isol√©s et g√©rables s√©par√©ment

**2. Double syst√®me d'auteurs (User XOR Character)**
- Permet posts HRP (auteur = user) et posts RP (auteur = character)
- Validation dans mod√®les Sequelize (MySQL ne supporte pas CHECK sur FK)

**3. Soft-delete sur toutes tables (sauf ethnies)**
- Historique des contenus supprim√©s pr√©serv√©
- Facilite mod√©ration et r√©cup√©ration

**4. R√©f√©rences circulaires r√©solues via migration 011**
- Pattern r√©utilisable pour futures relations complexes
- Rollback s√©curis√© (FK supprim√©es avant indexes)

**5. Permissions par faction/clan**
- Sections peuvent √™tre publiques ou restreintes
- Base pour futur syst√®me de permissions granulaire

---

## Scripts Utiles

### R√©initialiser la base de donn√©es
```bash
cd backend
npm run db:reset
```

### Seeders de production
```bash
npm run db:seed:prod              # Ex√©cuter seeders prod
npm run db:seed:prod:undo         # Annuler seeders prod
```

### Seeders de d√©veloppement
```bash
npm run db:seed:dev               # Ex√©cuter seeders dev
npm run db:seed:dev:undo          # Annuler seeders dev
```

### Vider une table sp√©cifique
```bash
npm run db:clear -- posts
npm run db:clear -- topics
```

---

**Derni√®re mise √† jour**: 2025-10-31
**Statut**: üîÑ Phase 1 compl√©t√©e - feature/seeders-review pr√™te √† merger
**Prochaine √©tape**: Merger seeders-review ‚Üí forum, puis d√©velopper API backend
